/* ===================================================
 * ğŸ”¤ MBTI 12ë¬¸í•­ â€” v2025.2 ë§ˆìŒ ë¦¬ë§ˆì¸ë“œ (ì•ˆì •íŒ)
 * - 5ì§€ì„ ë‹¤(0~4) / ì‘ë‹µì‹œê°„ Â±20% ë³´ì¡°(ì„ íƒ ìš°ì„ )
 * - 4ì¶•: E/I, S/N, T/F, J/P
 * - ê²°ê³¼: 4ê¸€ì ì½”ë“œ + ì„¤ëª… + ë§ˆìŒ ë¦¬ë§ˆì¸ë“œ + í˜ì–´ ë¼ë²¨
 * - ì•ˆì „ì¥ì¹˜: DOM ê°€ë“œ, ëŸ°íƒ€ì„ ì—ëŸ¬ ì‹œ ì‚¬ìš©ì ë©”ì„¸ì§€
 * =================================================== */
document.addEventListener('DOMContentLoaded', () => {
  try {
    // ---------- ë¬¸í•­ ----------
    const Q = [
      {axis:'EI', a:'E', q:'ì‚¬ëŒ ë§ì€ ìë¦¬ì—ì„œ ì—ë„ˆì§€ê°€ ì˜¤ë¥¸ë‹¤.'},
      {axis:'EI', a:'I', q:'í˜¼ìë§Œì˜ ì‹œê°„ì´ ê¼­ í•„ìš”í•˜ë‹¤.'},
      {axis:'EI', a:'E', q:'ì²˜ìŒ ë³¸ ì‚¬ëŒì—ê²Œ ë¨¼ì € ë§ì„ ê±°ëŠ” í¸ì´ë‹¤.'},

      {axis:'SN', a:'S', q:'ì‚¬ì‹¤Â·ê²½í—˜ì´ ì¤‘ìš”í•˜ë‹¤. ì¶”ìƒì€ ë‹µë‹µí•˜ë‹¤.'},
      {axis:'SN', a:'N', q:'ê°€ëŠ¥ì„±ê³¼ ì•„ì´ë””ì–´ë¥¼ ì´ì•¼ê¸°í•˜ëŠ” ê²Œ ì¦ê²ë‹¤.'},
      {axis:'SN', a:'S', q:'ìƒˆ ê°œë…ì€ êµ¬ì²´ì  ì˜ˆì‹œê°€ ìˆì„ ë•Œ ì´í•´ê°€ ì‰½ë‹¤.'},

      {axis:'TF', a:'T', q:'ì˜ì‚¬ê²°ì •ì—ì„œ ë…¼ë¦¬/ì •í™•ì„±ì´ ìš°ì„ ì´ë‹¤.'},
      {axis:'TF', a:'F', q:'ì‚¬ëŒë“¤ì˜ ê°ì •ê³¼ ê´€ê³„ ì˜í–¥ì„ ë¨¼ì € ë³¸ë‹¤.'},
      {axis:'TF', a:'T', q:'ë…¼ë¦¬ì  ëª¨ìˆœì„ ë³´ë©´ ë°”ë¡œ ì¡ê³  ì‹¶ë‹¤.'},

      {axis:'JP', a:'J', q:'ê³„íší‘œ/ë§ˆê°ì´ ìˆì–´ì•¼ ë§ˆìŒì´ í¸í•˜ë‹¤.'},
      {axis:'JP', a:'P', q:'ìƒí™© ë”°ë¼ ì¦‰í¥ì ìœ¼ë¡œ ì›€ì§ì´ëŠ” í¸ì´ë‹¤.'},
      {axis:'JP', a:'J', q:'í•  ì¼ì„ ë¯¸ë¦¬ ì •ë¦¬í•˜ê³  ì§„í–‰í•œë‹¤.'}
    ];

    // ---------- DOM ----------
    const step = document.getElementById('stepLabel');
    const bar  = document.getElementById('barFill');
    const qTxt = document.getElementById('qText');
    const wrap = document.getElementById('choiceWrap');
    const card = document.getElementById('card');
    const result = document.getElementById('result');
    const prev = document.getElementById('prev');
    const skip = document.getElementById('skip');

    if (!step || !bar || !qTxt || !wrap || !card || !result) {
      console.error('[MBTI] í•„ìˆ˜ DOM ìš”ì†Œ ëˆ„ë½');
      return;
    }

    // ---------- ìƒíƒœ ----------
    let idx = 0, start = Date.now();
    const ans = [], times = [];
    const S = {E:0,I:0,S:0,N:0,T:0,F:0,J:0,P:0};

    // ---------- ìœ í‹¸ ----------
    function weight(sec){
      if (sec < 1) return 0.9;
      if (sec < 4) return 1.0;
      if (sec < 8) return 1.15;
      return 1.10;
    }

    // ---------- ë Œë” ----------
    function render(){
      step.textContent = `${idx+1} / ${Q.length}`;
      bar.style.width = `${(idx/Q.length)*100}%`;
      qTxt.textContent = Q[idx].q;

      wrap.innerHTML = `
        <button class="choice" data-s="4" type="button">ë§¤ìš° ê·¸ë ‡ë‹¤</button>
        <button class="choice" data-s="3" type="button">ê·¸ë ‡ë‹¤</button>
        <button class="choice" data-s="2" type="button">ë³´í†µì´ë‹¤</button>
        <button class="choice ghost" data-s="1" type="button">ì•„ë‹ˆë‹¤</button>
        <button class="choice ghost" data-s="0" type="button">ì „í˜€ ì•„ë‹ˆë‹¤</button>
      `;

      const prevSel = ans[idx];
      if (prevSel !== undefined) {
        [...wrap.children].forEach(b=>{
          if (Number(b.dataset.s) === prevSel) b.classList.add('selected');
        });
      }

      [...wrap.children].forEach(btn=>{
        btn.addEventListener('click', ()=>{
          [...wrap.children].forEach(c=>c.classList.remove('selected'));
          btn.classList.add('selected');
          setTimeout(()=>choose(Number(btn.dataset.s)), 120);
        }, {passive:true});
      });

      start = Date.now();
    }

    // ---------- ì‘ë‹µ ----------
    function choose(s){
      const sec = (Date.now() - start) / 1000;
      const w = weight(sec);
      const adj = s + (s*(w-1)*0.2); // ì„ íƒ ìš°ì„ , Â±20% ë³´ì¡°
      ans[idx] = s; times[idx] = sec;
      S[Q[idx].a] += adj;
      next();
    }

    function next(){
      idx++;
      if (idx < Q.length) render();
      else finish();
    }

    prev?.addEventListener('click', ()=>{
      if (idx === 0) return;
      idx--;
      recalc(idx);
      render();
    });

    skip?.addEventListener('click', ()=>{
      ans[idx] = 0;
      times[idx] = (Date.now()-start)/1000;
      next();
    });

    function recalc(end){
      for (const k in S) S[k]=0;
      for (let i=0;i<end;i++){
        const sec = times[i]??3, w = weight(sec), s = ans[i]??0;
        const adj = s + (s*(w-1)*0.2);
        S[Q[i].a] += adj;
      }
    }

    // ---------- ê²°ì • ----------
    function pickPair(l,r){
      const lv=S[l], rv=S[r];
      if (Math.abs(lv-rv) < 0.01){
        // ê·¼ì†Œì°¨ íƒ€ì´ë¸Œë ˆì´ì»¤(ìµœê·¼ ì‘ë‹µ ê°€ì¤‘)
        let d=0;
        for (let i=Math.max(0, idx-3); i<idx; i++){
          const a=Q[i]?.a;
          if (a===l || a===r){
            const w=weight(times[i]??3);
            d += (a===l ? 1 : -1) * w;
          }
        }
        return d>=0 ? l : r;
      }
      return (lv>=rv) ? l : r;
    }

    function labelPair(l,r){
      const lv=S[l], rv=S[r], total=(lv+rv)||1;
      const dom = Math.max(lv,rv)/total;
      if (dom>=0.75) return 'ë§¤ìš° ê°•í•¨';
      if (dom>=0.60) return 'ê°•í•¨';
      if (dom>=0.45) return 'ê· í˜•';
      if (dom>=0.30) return 'ì•½í•¨';
      return 'ë§¤ìš° ì•½í•¨';
    }

    // ---------- ê²°ê³¼ ----------
    function finish(){
      try {
        card.style.display='none';
        bar.style.width='100%';
        const code = `${pickPair('E','I')}${pickPair('S','N')}${pickPair('T','F')}${pickPair('J','P')}`;

        const M = {
          ISTJ:{t:'ğŸ§­ ì›ì¹™ ìˆ˜í˜¸ì',q:'â€œì§ˆì„œëŠ” ë‚˜ì˜ ì–¸ì–´, ì„±ì‹¤ì€ ë‚˜ì˜ ë°©ì‹.â€',
          d:'ì‹¤ì§ˆì ì´ê³  ì±…ì„ê°ì´ ê°•í•œ ìœ í˜•ì´ì—ìš”. ê³„íšê³¼ ê·œì¹™ ì†ì—ì„œ ì•ˆì •ê°ì„ ëŠë¼ë©°, ì•½ì†ì„ ì§€í‚¤ëŠ” ì¼ì— ìë¶€ì‹¬ì„ ê°€ì§‘ë‹ˆë‹¤. ë•Œë¡œëŠ” ìœµí†µì„±ì´ ë¶€ì¡±í•´ ë³´ì¼ ìˆ˜ ìˆì§€ë§Œ, ê·¸ë§Œí¼ ì‹ ë¢°ë¥¼ ì£¼ëŠ” íƒ€ì…ì´ì—ìš”.',
          r:'ì˜¤ëŠ˜ì€ ê·œì¹™ë³´ë‹¤ ê¸°ë¶„ì„ 10% ë” ë°˜ì˜í•´ë³´ì„¸ìš”. ì˜ˆìƒ ë°–ì˜ ì—¬ìœ ê°€ ì¢‹ì€ ê· í˜•ì´ ë©ë‹ˆë‹¤.'},
          ISFJ:{t:'ğŸ¯ ë”°ëœ»í•œ ìˆ˜í˜¸ì',q:'â€œëˆ„êµ°ê°€ì˜ í‰ì˜¨ì´ ê³§ ë‚˜ì˜ í‰ì˜¨.â€',
          d:'ì„¬ì„¸í•˜ê³  í—Œì‹ ì ì¸ ì„±í–¥ìœ¼ë¡œ ì£¼ë³€ ì‚¬ëŒì„ ì˜ ëŒë³´ëŠ” ìœ í˜•ì´ì—ìš”. ì‹ ë¢°ë°›ëŠ” ì¡´ì¬ë¡œì„œ ì•ˆì •ëœ ê´€ê³„ë¥¼ ì¤‘ì‹œí•©ë‹ˆë‹¤. ë‹¤ë§Œ â€œë‚´ ë§ˆìŒì˜ ê³µê°„â€ì„ ì±™ê¸°ëŠ” ì‹œê°„ë„ í•„ìš”í•´ìš”.',
          r:'ì˜¤ëŠ˜ì€ íƒ€ì¸ì„ ëŒë³´ê¸° ì „, ë‚˜ë¥¼ ìœ„í•´ ë”°ëœ»í•œ ì°¨ í•œ ì”ì„ ë‚´ë ¤ë³´ì„¸ìš”.'},
          INFJ:{t:'ğŸŒ™ í†µì°°í˜• ì¡°í™”ì',q:'â€œì˜ë¯¸ ì—†ëŠ” ì¼ì—” ì—ë„ˆì§€ë¥¼ ì“°ì§€ ì•ŠëŠ”ë‹¤.â€',
          d:'ê¹Šì´ ìˆëŠ” í†µì°°ë ¥ê³¼ ì§ê´€ìœ¼ë¡œ ì‚¬ëŒì˜ ë³¸ì§ˆì„ ê¿°ëš«ì–´ìš”. ì´ìƒì ì´ë©´ì„œë„ í˜„ì‹¤ì ì¸ ì¡°í™”ë¥¼ ì¶”êµ¬í•˜ì§€ë§Œ, ê°ì •ì†Œëª¨ê°€ í´ ìˆ˜ ìˆì–´ìš”.',
          r:'ì˜¤ëŠ˜ì€ ìƒê°ì„ ì ì‹œ ë©ˆì¶”ê³ , â€˜ì§€ê¸ˆ ë‚´ ê°ì •â€™ì„ ê¸€ í•œ ì¤„ë¡œ ì ì–´ë³´ì„¸ìš”.'},
          INTJ:{t:'ğŸ›°ï¸ ê³„íš ê±´ì¶•ê°€',q:'â€œëª©í‘œ ì—†ëŠ” í•˜ë£¨ëŠ” ë°©í–¥ ìƒì€ í•­í•´ë‹¤.â€',
          d:'ì „ëµì  ì‚¬ê³ ì™€ íš¨ìœ¨ì„ ì¤‘ì‹œí•˜ëŠ” ìœ í˜•ì´ì—ìš”. ì¥ê¸°ì  ë¹„ì „ì„ ì„¸ìš°ë©° ë…ë¦½ì ìœ¼ë¡œ ì›€ì§ì´ì§€ë§Œ, ë•Œë•Œë¡œ ê°ì • í‘œí˜„ì´ ë¶€ì¡±í•´ ë³´ì¼ ìˆ˜ ìˆì–´ìš”.',
          r:'í•˜ë£¨ ì¤‘ 10ë¶„ì€ â€œë…¼ë¦¬â€ ëŒ€ì‹  â€œê°ì •â€ì„ ë“¤ì—¬ë‹¤ë³´ëŠ” ì‹œê°„ìœ¼ë¡œ ë‚¨ê²¨ë³´ì„¸ìš”.'},
          ISTP:{t:'ğŸ§° í˜„ì‹¤ íƒêµ¬ì',q:'â€œì§ì ‘ í•´ë´ì•¼ ì§ì„±ì´ í’€ë¦°ë‹¤.â€',
          d:'ë¬¸ì œ í•´ê²°ê³¼ ì‹¤ìš©ì  ì ‘ê·¼ì„ ì¢‹ì•„í•´ìš”. ììœ ë¡œìš´ ì‚¬ê³ ë¡œ ìƒˆë¡œìš´ ê¸°ìˆ ì´ë‚˜ ë°©ë²•ì„ ì‹œë„í•˜ì§€ë§Œ, ê°ì • í‘œí˜„ì—ëŠ” ì„œíˆ´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
          r:'ì˜¤ëŠ˜ì€ â€˜í•´ê²°â€™ë³´ë‹¤ â€˜ê³µìœ â€™ì— ì§‘ì¤‘í•´ë³´ì„¸ìš”. ê°ì •ë„ ì‹¤í—˜ì˜ ì¼ë¶€ì˜ˆìš”.'},
          ISFP:{t:'ğŸƒ ë¶€ë“œëŸ¬ìš´ ì‹¤ì²œê°€',q:'â€œì¡°ìš©íˆ, ê·¸ëŸ¬ë‚˜ ê¾¸ì¤€íˆ.â€',
          d:'ë”°ëœ»í•˜ê³  ììœ ë¡œìš´ ê°ì„±í˜•ì´ì—ìš”. ì•„ë¦„ë‹¤ì›€ê³¼ ì¡°í™”ë¥¼ ì¤‘ìš”ì‹œí•˜ë©°, íƒ€ì¸ì˜ ê¸°ë¶„ì„ ì„¸ì‹¬íˆ ì‚´í•ë‹ˆë‹¤.',
          r:'ì˜¤ëŠ˜ í•˜ë£¨ëŠ” â€œì‹«ì€ ê±¸ í”¼í•˜ê¸°ë³´ë‹¤ ì¢‹ì€ ê±¸ ì„ íƒí•˜ê¸°â€ë¡œ ë°©í–¥ì„ ë°”ê¿”ë³´ì„¸ìš”.'},
          INFP:{t:'ğŸŒ¸ ë§ˆìŒ ë””ìì´ë„ˆ',q:'â€œì§„ì‹¬ì€ ì²œì²œíˆ ì „í•´ì§„ë‹¤.â€',
          d:'ì´ìƒì ì´ê³  ê°ìˆ˜ì„±ì´ í’ë¶€í•œ ìœ í˜•ì´ì—ìš”. íƒ€ì¸ì˜ ê°ì •ì„ ê¹Šì´ ì´í•´í•˜ì§€ë§Œ, ë‚´ë©´ ê³ ë¯¼ì´ ë§ì„ ìˆ˜ ìˆì–´ìš”.',
          r:'ë‚´ì¼ì´ ì•„ë‹Œ ì˜¤ëŠ˜, ë§ˆìŒì´ ëŒë¦¬ëŠ” ì¼ í•˜ë‚˜ë¥¼ ë°”ë¡œ í•´ë³´ì„¸ìš”.'},
          INTP:{t:'ğŸ” ê°œë… íƒêµ¬ì',q:'â€œì™œ?ë¥¼ ë˜ì§€ëŠ” ê²Œ ë‚˜ì˜ ìŠµê´€.â€',
          d:'ë…¼ë¦¬ì™€ ì•„ì´ë””ì–´ë¥¼ ì¦ê¸°ëŠ” ë¶„ì„í˜•ì´ì—ìš”. ì°½ì˜ì ì¸ í†µì°°ë¡œ ë¬¸ì œë¥¼ ìƒˆë¡­ê²Œ ë°”ë¼ë³´ì§€ë§Œ, ì‹¤í–‰ì´ ë”ë”œ ìˆ˜ ìˆì–´ìš”.',
          r:'ì˜¤ëŠ˜ì€ ìƒê° ëŒ€ì‹  â€œì‘ì€ ì‹¤í—˜â€ í•˜ë‚˜ë¥¼ ì‹¤í–‰í•´ë³´ì„¸ìš”.'},
          ESTP:{t:'âš¡ ì—ë„ˆì§€ ì•¡ì…˜ëŸ¬',q:'â€œì§€ê¸ˆ, ë°”ë¡œ í–‰ë™!â€',
          d:'ì¦‰í¥ì ì´ê³  ëª¨í—˜ì‹¬ì´ ê°•í•œ ìœ í˜•ì´ì—ìš”. ìƒí™© íŒë‹¨ì´ ë¹ ë¥´ê³  ì‚¬êµì ì´ì§€ë§Œ, ë•Œë¡œëŠ” ê¹Šì€ ê³ ë¯¼ì„ ê±´ë„ˆë›°ê¸° ì‰¬ì›Œìš”.',
          r:'ì˜¤ëŠ˜ì€ â€œì ê¹ ë©ˆì¶¤ 10ì´ˆâ€ë¥¼ ì„ ë¬¼í•˜ì„¸ìš”. ì†ë„ë¥¼ ì¡°ì ˆí•˜ë©´ ë” ì˜¤ë˜ ë‹¬ë¦´ ìˆ˜ ìˆì–´ìš”.'},
          ESFP:{t:'ğŸ‰ ë¶„ìœ„ê¸° ë©”ì´ì»¤',q:'â€œí•¨ê»˜ ìˆì„ ë•Œ ê°€ì¥ ë‚˜ë‹µë‹¤.â€',
          d:'ì‚¬ëŒë“¤ê³¼ ì–´ìš¸ë¦¬ëŠ” ê±¸ ì¢‹ì•„í•˜ê³  ìœ ì¾Œí•œ ì—ë„ˆì§€ë¥¼ ì „íŒŒí•´ìš”. ì¦‰í¥ì ì´ì§€ë§Œ ë‹¤ì •í•˜ë©°, ë°ì€ ë¶„ìœ„ê¸°ì˜ ì¤‘ì‹¬ì´ ë©ë‹ˆë‹¤.',
          r:'ì˜¤ëŠ˜ì€ â€œí˜¼ìì„œë„ ì¦ê±°ìš´ ì‹œê°„â€ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”. ë‚˜ë„ ë‚´ ì¹œêµ¬ì˜ˆìš”.'},
          ENFP:{t:'ğŸŒˆ ì•„ì´ë””ì–´ ìŠ¤íŒŒí¬ëŸ¬',q:'â€œì˜ê°ì€ ì—°ê²° ì†ì—ì„œ í”¼ì–´ë‚œë‹¤.â€',
          d:'ì—´ì •ê³¼ ì°½ì˜ë ¥ì´ ë„˜ì¹˜ëŠ” ììœ ë¡œìš´ ì˜í˜¼ì´ì—ìš”. ë‹¤ì–‘í•œ ê°€ëŠ¥ì„±ì„ ì¦ê¸°ì§€ë§Œ, ì§‘ì¤‘ë ¥ì´ í©ì–´ì§ˆ ìˆ˜ ìˆì–´ìš”.',
          r:'ì˜¤ëŠ˜ í•˜ë£¨ â€œê°€ì¥ ë‚˜ë¥¼ í¥ë¯¸ë¡­ê²Œ í•˜ëŠ” ì¼ í•˜ë‚˜â€ë§Œ ë‚¨ê²¨ë‘ì„¸ìš”.'},
          ENTP:{t:'ğŸ§  ë°œìƒ í•´ì»¤',q:'â€œí‹€ì„ ê¹¨ì•¼ ì§„ì§œê°€ ë³´ì¸ë‹¤.â€',
          d:'ìƒˆë¡œìš´ ì•„ì´ë””ì–´ì™€ í† ë¡ ì„ ì¦ê¸°ë©° ë³€í™”ë¥¼ ë‘ë ¤ì›Œí•˜ì§€ ì•Šì•„ìš”. ë…¼ìŸì ì¼ ìˆ˜ ìˆì§€ë§Œ ê·¸ë§Œí¼ ì°½ì˜ì ì´ì—ìš”.',
          r:'ì˜¤ëŠ˜ì€ â€œë¹„íŒâ€ ëŒ€ì‹  â€œì œì•ˆâ€ìœ¼ë¡œ ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”.'},
          ESTJ:{t:'ğŸ—ï¸ ì‹¤í–‰ ê´€ë¦¬ì',q:'â€œê³„íš ì—†ëŠ” ì¼ì€ ë¶ˆì•ˆí•˜ë‹¤.â€',
          d:'ì²´ê³„ì™€ íš¨ìœ¨ì„ ì¤‘ì‹œí•˜ë©° ì±…ì„ê°ì´ ê°•í•œ ë¦¬ë”í˜•ì´ì—ìš”. ì¼ì²˜ë¦¬ê°€ ë¹ ë¥´ê³  ëª…í™•í•˜ì§€ë§Œ, ìœ ì—°í•¨ì´ ë¶€ì¡±í•  ë•Œë„ ìˆì–´ìš”.',
          r:'ì˜¤ëŠ˜ì€ ê³„íší‘œì— â€œíœ´ì‹ 30ë¶„â€ì„ ì •ì‹ìœ¼ë¡œ ë„£ì–´ë³´ì„¸ìš”.'},
          ESFJ:{t:'ğŸ¤ ë‹¤ì •í•œ ì¡°ìœ¨ì',q:'â€œëª¨ë‘ê°€ í¸í•´ì•¼ ë‚˜ë„ í¸í•˜ë‹¤.â€',
          d:'ì‚¬ëŒë“¤ì˜ ê°ì •ì„ ì„¸ì‹¬í•˜ê²Œ ì‚´í”¼ëŠ” í˜‘ë ¥í˜•ì´ì—ìš”. ì¹œì ˆí•˜ê³  ë°°ë ¤ì‹¬ì´ ê¹Šì§€ë§Œ, ë•Œë¡œëŠ” ìŠ¤ìŠ¤ë¡œë¥¼ í›„ìˆœìœ„ë¡œ ë¯¸ë£¨ê¸°ë„ í•´ìš”.',
          r:'ì˜¤ëŠ˜ì€ â€œë‚˜ë§Œì„ ìœ„í•œ 30ë¶„â€ì„ ë°˜ë“œì‹œ í™•ë³´í•˜ì„¸ìš”.'},
          ENFJ:{t:'ğŸŒ ì˜ê° ë¦¬ë”',q:'â€œí•¨ê»˜ ì„±ì¥í•  ë•Œ ë¹›ë‚œë‹¤.â€',
          d:'íƒ€ì¸ì˜ ê°€ëŠ¥ì„±ì„ ë°œê²¬í•˜ê³  ëŒì–´ì£¼ëŠ” ë¦¬ë”í˜•ì´ì—ìš”. ê³µê°ë ¥ê³¼ ì¶”ì§„ë ¥ì„ ê²¸ë¹„í–ˆì§€ë§Œ, ê³¼í•˜ê²Œ ì±…ì„ì§ˆ ë•Œê°€ ìˆì–´ìš”.',
          r:'ì˜¤ëŠ˜ì€ â€œë‚´ ë§ˆìŒì˜ ì—¬ë°±â€ì„ ìœ„í•´ íœ´ëŒ€í°ì„ 1ì‹œê°„ë§Œ ë®ì–´ë³´ì„¸ìš”.'},
          ENTJ:{t:'ğŸš€ ì „ëµ ì§€íœ˜ì',q:'â€œë°©í–¥ì´ ëª…í™•í•˜ë©´ ì†ë„ëŠ” ë”°ë¼ì˜¨ë‹¤.â€',
          d:'ëª©í‘œ ì§€í–¥ì ì´ê³  ê²°ë‹¨ë ¥ ìˆëŠ” ë¦¬ë”í˜•ì´ì—ìš”. íš¨ìœ¨ê³¼ ì„±ê³¼ë¥¼ ì¤‘ì‹œí•˜ì§€ë§Œ, ê°ì •ì˜ ë¯¸ì„¸í•œ ì‹ í˜¸ë¥¼ ë†“ì¹  ìˆ˜ ìˆì–´ìš”.',
          r:'ì˜¤ëŠ˜ì€ â€œíš¨ìœ¨â€ ëŒ€ì‹  â€œì˜¨ê¸°â€ë¥¼ í•œ ë¬¸ì¥ ì•ˆì— ì„ì–´ë³´ì„¸ìš”.'}
        };

        const info = M[code] || {
          t:'â˜ï¸ ê· í˜•ëª½ì‹¤í˜•',
          q:'â€œìƒí™©ì— ë§ê²Œ í†¤ì„ ë°”ê¾¸ëŠ” ìœ ì—°í•œ ë‚˜.â€',
          d:'ëª¨ë“  ì¶•ì´ ê³ ë¥´ê²Œ ë°œë‹¬í•œ ê· í˜•í˜•ì´ì—ìš”. ì–´ë–¤ ìƒí™©ì—ì„œë„ ì¡°í™”ë¡­ê²Œ ì ì‘í•˜ë©° ì•ˆì •ê°ì„ ì¤ë‹ˆë‹¤.',
          r:'ê· í˜•ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ì„œë¼ë„, ë•Œë¡œëŠ” â€œê¸°ìš¸ì–´ë³´ê¸°â€ê°€ í•„ìš”í•´ìš”.'
        };

        const pairsHTML = [
          {n:'E/I',l:'E',r:'I'},
          {n:'S/N',l:'S',r:'N'},
          {n:'T/F',l:'T',r:'F'},
          {n:'J/P',l:'J',r:'P'}
        ].map(p => `
          <div class="pair">
            <span><b>${p.n}</b></span>
            <span>${labelPair(p.l,p.r)}</span>
          </div>
        `).join('');

        result.innerHTML = `
          <div class="result-card">
            <div class="result-hero">
              <img src="../assets/mbti.png" alt="MBTI ì•„ì´ì½˜" onerror="this.src='../assets/mongsil.png'">
              <div>
                <div class="result-title">${info.t} (${code})</div>
                <div class="result-desc">${info.q}</div>
              </div>
            </div>

            <p style="margin:8px 0">${info.d}</p>

            <div class="pairs-grid">${pairsHTML}</div>

            <div class="mind-remind">
              <b>ğŸŒ¿ ë§ˆìŒ ë¦¬ë§ˆì¸ë“œ:</b> ${info.r}
            </div>

            <div class="result-actions">
              <a class="start" href="../index.html">ë©”ì¸ìœ¼ë¡œ</a>
              <button class="start" type="button" onclick="location.reload()">ë‹¤ì‹œ í…ŒìŠ¤íŠ¸</button>
            </div>
          </div>
        `;
        result.style.display='block';
      } catch (err) {
        console.error('[MBTI finish] ', err);
        result.innerHTML = `
          <div class="result-card">
            <p>ê²°ê³¼ë¥¼ ê·¸ë¦¬ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>
          </div>
        `;
        result.style.display='block';
      }
    }

    // ì‹œì‘
    render();
  } catch (e) {
    console.error('[MBTI init] ', e);
    const container = document.getElementById('result');
    if (container) {
      container.innerHTML = `<div class="result-card"><p>ì´ˆê¸°í™” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.</p></div>`;
      container.style.display='block';
    }
  }
});